<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
    <title>Trang ch·ªß | Gym Health Monitor</title>

    <th:block th:replace="base :: head"></th:block>
</head>

<body>
    <!-- Header -->
    <div th:replace="base :: header"></div>
    <div th:replace="base :: message"></div>

    <main class="container mt-4">
        <h5 class="text-center">Ch√†o m·ª´ng <strong bsec:authentication="name"></strong> ƒë·∫øn v·ªõi h·ªá th·ªëng c·ªßa ch√∫ng t√¥i!
        </h5>
      
        <div class="filter-container mb-3">
            <label for="fromDate">T·ª´ ng√†y:</label>
            <input type="date" id="fromDate">

            <label for="toDate">ƒê·∫øn ng√†y:</label>
            <input type="date" id="toDate">

            <button class="btn btn-success" onclick="loadChart()">L·ªçc</button>
        </div>

        <!-- Bi·ªÉu ƒë·ªì -->
        <canvas id="userChart" class="mb-4"></canvas>

        <div class="row">
            <div class="col-md-4 mb-2">
                <div class="card shadow-sm">
                    <div class="card-body">
                        <h5 class="card-title">üèãÔ∏è Th√†nh vi√™n</h5>
                        <p class="card-text">Qu·∫£n l√Ω danh s√°ch h·ªôi vi√™n, g√≥i t·∫≠p.</p>
                        <a th:href="@{/users}" class="btn btn-primary">Xem chi ti·∫øt</a>
                    </div>
                </div>
            </div>

            <div class="col-md-4 mb-2">
                <div class="card shadow-sm">
                    <div class="card-body">
                        <h5 class="card-title">üìÖ L·ªãch t·∫≠p</h5>
                        <p class="card-text">Qu·∫£n l√Ω l·ªãch t·∫≠p, hu·∫•n luy·ªán vi√™n.</p>
                        <a th:href="@{/schudules}" class="btn btn-success">Xem chi ti·∫øt</a>
                    </div>
                </div>
            </div>

            <div class="col-md-4 mb-2">
                <div class="card shadow-sm">
                    <div class="card-body">
                        <h5 class="card-title">üí™ G√≥i t·∫≠p</h5>
                        <p class="card-text">Qu·∫£n l√Ω danh s√°ch g√≥i t·∫≠p, gi√° c·∫£ v√† th·ªùi h·∫°n.</p>
                        <a th:href="@{/packages}" class="btn btn-warning text-white">Xem chi ti·∫øt</a>
                    </div>
                </div>
            </div>

            <div class="col-md-4 mb-2">
                <div class="card shadow-sm">
                    <div class="card-body">
                        <h5 class="card-title">üìà B√°o c√°o doanh thu</h5>
                        <p class="card-text">Xem b√°o c√°o doanh thu v√† ph√¢n t√≠ch.</p>
                        <a th:href="@{/stats}" class="btn btn-info text-white">Xem chi ti·∫øt</a>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <div th:replace="base :: footer"></div>

    <script th:inline="javascript">
        async function loadChart() {
            const fromDate = document.getElementById("fromDate").value;
            const toDate = document.getElementById("toDate").value;

            const url = new URL([[@{/stats/users}]], window.location.origin);
            if (fromDate)
                url.searchParams.append("fromDate", fromDate);
            if (toDate)
                url.searchParams.append("toDate", toDate);

            const response = await fetch(url);
            const data = await response.json();

            const ctx = document.getElementById('userChart').getContext('2d');
            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: data.labels,
                    datasets: [{
                        label: 'S·ªë th√†nh vi√™n ƒëƒÉng k√Ω',
                        data: data.values,
                        borderColor: 'blue',
                        borderWidth: 2,
                        fill: false
                    }]
                }
            });
        }

        window.onload = loadChart;
    </script>
</body>

</html>