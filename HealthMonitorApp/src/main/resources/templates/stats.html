<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
    <title>B√°o c√°o | Gym Health Monitor</title>

    <th:block th:replace="base :: head"></th:block>
</head>

<body>
    <div th:replace="base :: header"></div>
    <div th:replace="base :: message"></div>

    <main class="container mt-3">
        <h2 class="text-center mb-3 w-100">üìà B√°o c√°o</h2>
        
        <div class="filter-container mb-3">
            <label for="fromDate">T·ª´ ng√†y:</label>
            <input type="date" id="fromDate">

            <label for="toDate">ƒê·∫øn ng√†y:</label>
            <input type="date" id="toDate">

            <button class="btn btn-success" onclick="loadRevenueChart()">L·ªçc</button>
        </div>
        
        <canvas id="chart" class="mb-4"></canvas>
        
    </main>

    <div th:replace="base :: footer"></div>

    <script th:inline="javascript">
        async function loadRevenueChart() {
            const fromDate = document.getElementById("fromDate").value;
            const toDate = document.getElementById("toDate").value;

            const url = new URL([[@{/stats/revenue}]], window.location.origin);
            if (fromDate)
                url.searchParams.append("fromDate", fromDate);
            if (toDate)
                url.searchParams.append("toDate", toDate);

            const response = await fetch(url);
            const data = await response.json();

            const ctx = document.getElementById('chart').getContext('2d');
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: data.labels,
                    datasets: [{
                        label: 'T·ªïng doanh thu',
                        data: data.values,
                        backgroundColor: 'red',
                        fill: false
                    }]
                }
            });
        }

        window.onload = loadRevenueChart;
    </script>
</body>

</html>